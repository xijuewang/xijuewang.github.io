(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{437:function(s,t,a){"use strict";a.r(t);var n=a(56),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"介绍"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#介绍"}},[s._v("#")]),s._v(" 介绍")]),s._v(" "),a("p",[s._v("​\t游标（Cursor）是处理数据的一种方法，为了查看或者处理结果集中的数据，游标提供了在结果集中一次以行或者多行前进或向后浏览数据的能力。我们可以把游标当作一个指针，它可以指定结果中的任何位置，然后允许用户对指定位置的数据进行处理。")]),s._v(" "),a("h3",{attrs:{id:"_1-游标的组成"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-游标的组成"}},[s._v("#")]),s._v(" 1.  游标的组成")]),s._v(" "),a("p",[s._v("​\t游标包含两个部分：一个是游标结果集、一个是游标位置。\n游标结果集：定义该游标得SELECT语句返回的行的集合。游标位置：指向这个结果集某一行的当前指针。")]),s._v(" "),a("h3",{attrs:{id:"_2-游标的分类"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-游标的分类"}},[s._v("#")]),s._v(" 2.  游标的分类")]),s._v(" "),a("p",[s._v("​\t游标共有3类：API服务器游标、Transaction-SQL游标和API客户端游标。\n​\t其中前两种游标都是运行在服务器上的，所以又叫做服务器游标。")]),s._v(" "),a("h3",{attrs:{id:"_3-游标的生命周期"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-游标的生命周期"}},[s._v("#")]),s._v(" 3.  游标的生命周期")]),s._v(" "),a("p",[s._v("​\t游标的生命周期包含有五个阶段：声明游标、打开游标、读取游标数据、关闭游标、释放游标。\n声明游标是为游标指定获取数据时所使用的Select语句，声明游标并不会检索任何数据，它只是为游标指明了相应的Select 语句。")]),s._v(" "),a("h2",{attrs:{id:"msdn中定义语句"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#msdn中定义语句"}},[s._v("#")]),s._v(" MSDN中定义语句")]),s._v(" "),a("div",{staticClass:"language-sql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DECLARE")]),s._v(" cursor_name "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" INSENSITIVE "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" SCROLL "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CURSOR")]),s._v(" \n     "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FOR")]),s._v(" select_statement \n     "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FOR")]),s._v(" { "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("READ")]),s._v(" ONLY "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("UPDATE")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("OF")]),s._v(" column_name "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("n "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" } "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nTransact"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SQL")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Extended")]),s._v(" Syntax\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DECLARE")]),s._v(" cursor_name "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CURSOR")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("LOCAL")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("GLOBAL")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" \n     "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" FORWARD_ONLY "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" SCROLL "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" \n     "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" STATIC "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" KEYSET "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" DYNAMIC "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" FAST_FORWARD "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" \n     "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" READ_ONLY "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" SCROLL_LOCKS "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" OPTIMISTIC "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" \n     "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" TYPE_WARNING "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" \n     "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FOR")]),s._v(" select_statement \n     "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FOR")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("UPDATE")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("OF")]),s._v(" column_name "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("n "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("h2",{attrs:{id:"应用示例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#应用示例"}},[s._v("#")]),s._v(" 应用示例")]),s._v(" "),a("div",{staticClass:"language-sql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("create")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("table")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#table( Id int, Name nvarchar(512))")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("insert")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("into")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#table values( 1, N'dong')")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("insert")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("into")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#table values( 2, N'liu')")]),s._v("\n \n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("declare")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@name")]),s._v(" nvarchar"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("declare")]),s._v(" MyCursor "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("cursor")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" Name "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#table --定义游标，游标数据集来源临时表#table")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("open")]),s._v(" MyCursor "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("--打开游标以供下面代码使用")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fetch")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("next")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" MyCursor "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("into")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@name")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("--将游标指向的值赋值给临时变量@name，游标指向下一条数据")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("while")]),s._v(" @"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@FETCH_STATUS")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("--判断游标是否到最后一条记录")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("begin")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@name")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fetch")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("next")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" MyCursor "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("into")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@name")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("close")]),s._v(" MyCursor "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("--关闭游标")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("deallocate")]),s._v(" MyCursor "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 释放最后的游标引用时")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("drop")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("table")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#table")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br")])])])}),[],!1,null,null,null);t.default=e.exports}}]);